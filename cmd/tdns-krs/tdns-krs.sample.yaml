# Sample configuration file for tdns-krs (Key Receiving Service)
# Copy this to /etc/tdns/tdns-krs.yaml and customize

service:
   name:		TDNS-KRS
   verbose:		true
   debug:		true

log:
   file:		/var/log/tdns/tdns-krs.log

apiserver:
   usetls:		true
   addresses:     	[ 127.0.0.1:8990 ]
   apikey:         	winter-is-coming-santa-stuck-in-chimney
   certfile:		/etc/tdns/certs/localhost.crt
   keyfile:		/etc/tdns/certs/localhost.key

# DNS engine configuration for handling NOTIFY messages
# Note: This is at top level but gets merged into the krs section during parsing
dnsengine:
   addresses:		[ 127.0.0.1:5355, '[::1]:5355' ]  # Addresses to listen on for DNS NOTIFY
   transports:		[ do53 ]  # Transport protocols: do53, dot, doh, doq
   certfile:		/etc/tdns/certs/localhost.crt  # Required for dot, doh, doq
   keyfile:		/etc/tdns/certs/localhost.key  # Required for dot, doh, doq

krs:
   database:
      dsn:		/var/lib/tdns/krs.db  # SQLite database file path
   
   node:
      # Node ID must be a Fully Qualified Domain Name (FQDN) with trailing dot
      # This ID must match exactly the node ID registered in the KDC
      # Example: "cpt.axfr.net." or "node1.example.com."
      id:			cpt.axfr.net.  # Must match node ID in KDC (FQDN with trailing dot)
      long_term_priv_key:	/etc/tdns/krs/cpt.axfr.net.privatekey  # Path to HPKE long-term private key file
      kdc_address:		127.0.0.1:5354  # KDC server address (IP:port)
   
   control_zone:		kdc.example.com.  # Control zone for KMCTRL records
   
   # use_chunk: If true, use CHUNK format instead of MANIFEST+OLDCHUNK
   # CHUNK is a unified RR type that combines manifest and chunk functionality
   # into a single record type. When enabled, KRS will query for CHUNK records
   # (sequence 0 for manifest, 1+ for data chunks) instead of separate MANIFEST
   # and OLDCHUNK records.
   # Default: false (uses MANIFEST+OLDCHUNK format)
   # Set to true to use the new CHUNK format
   use_chunk:		false  # Set to true to use CHUNK format

